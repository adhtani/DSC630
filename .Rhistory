new_df$Direction[new_df$Direction == "UP"] <- 1
knn.data <- sample(1:nrow(new_df),size=nrow(new_df)*0.7,replace = FALSE)
## the normalization function is created
nor <-function(x) { (x -min(x))/(max(x)-min(x))   }
## Run nomalization for predictor variables.
norm <- as.data.frame(lapply(new_df[,c(3,5,8)], nor))
summary(norm)
train.x <- norm[knn.data,] # 70% training data
test.x <- norm[-knn.data,] # remaining 30% test data
## the creating dataframes for "credibility"
train.y <- new_df[knn.data,6]
test.y  <- new_df[-knn.data,6]
k = round(sqrt(NROW(train.y)), digits = 0)
knn.1 =  knn(train=train.x, test=test.x, cl=train.y, k=k)
## create confusion matrix
tab <- table(knn.1,test.y)
# accuracy
accuracy <- function(x){sum(diag(x)/(sum(rowSums(x)))) * 100}
accuracy(tab)
summary(GLM.2)
df <- read.csv("TestDataSet2.csv")
kable(head(df,5), caption="First Five Data Set Values")
# Model
GLM.2 <- glm(Actual ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.2)
df
df$predicted.2 = predict(GLM.2, newdata=df, type="response")
kable(table(df$Actual, df$predicted.2> 0.5))
df
GLM.1 <- glm(Actual ~ Direction + Momentum, family=binomial(logit), data=df)
summary(GLM.1)
df$predicted.1 = predict(GLM.1, newdata=df, type="response")
accuracy_0.5 = (nrow(df[df$predicted.1 >0.5,])/nrow(df))*100
accuracy_0.5
accuracy_0.6 = (nrow(df[df$predicted.1 >0.6,])/nrow(df))*100
accuracy_0.6
exp(1)
summary(GLM.2)
df <- read.csv("TestDataSet2.csv")
df$Direction[df$Direction == "DOWN"] <- 0
df$Direction[df$Direction == "UP"] <- 1
kable(head(df,5), caption="First Five Data Set Values")
GLM.1 <- glm(Actual ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.1)
num <- exp(2.26914 + 2.18336*df$Direction - 0.16251*df$Momentum + 0.06246*df$Alpha2)
df
num <- exp(2.26914 + 2.18336*df$Direction - 0.16251*df$Momentum + 0.06246*df$Alpha2)
2.18336*df$Direction
df$Direction
df$Direction <- as.numeric(df$Direction)
df
GLM.2 <- glm(Actual ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.2)
num <- exp(2.26914 + 2.18336*df$Direction - 0.16251*df$Momentum + 0.06246*df$Alpha2)
num/(num+1)
df$predicted.2 = predict(GLM.2, newdata=df, type="response")
df
library(readr)
library(caret)
import("caret")
install.packages("caret")
install.packages("caret")
library(readr)
library(caret)
library(caret)
df
library(knitr)
library(ggplot2)
library(tidyverse)
df <- read.csv("TestDataSet2.csv")
df$Direction[df$Direction == "DOWN"] <- 0
df$Direction[df$Direction == "UP"] <- 1
kable(head(df,5), caption="First Five Data Set Values")
# Model
GLM.2 <- glm(Actual ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.2)
exp(coef(GLM.2))  # Exponentiated coefficients ("odds ratios")
GLM.3 <- glm(Actual ~ Direction + Difference + Momentum + Alpha2, family=binomial(logit), data=df)
summary(GLM.3)
exp(coef(GLM.3))  # Exponentiated coefficients ("odds ratios")
contrasts(cats$Actual)
contrasts(df$Actual)
df$Actual.f <- factors(df$Actual)
df$Actual.f <- factor(df$Actual)
contrasts(df$Actual.f)
inTrain <- createDataPartition(y = df$Actual.f, p = .60, list = FALSE)
training <- df[inTrain,]
testing <- df[-inTrain,]
library(caret)
inTrain <- createDataPartition(y = df$Actual.f, p = .60, list = FALSE)
training <- df[inTrain,]
testing <- df[-inTrain,]
head(df, 2)
train <- head(df, 21)
test <- tail(df, 9)
train
test
df
dim(train)
dim(test)
GLM.2 <- glm(Actual.f ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.2)
summary(GLM.2)
GLM.3 <- glm(Actual.f ~ Direction + Momentum + Alpha2, family=binomial(logit), data=train)
summary(GLM.3)
dim(df)[1]
prob = predict(GLM.2, newdata=df, type="response")
pred = rep("DOWN", dim(df)[1])
pred[prob > .5] = "UP"
table(pred, df$Actual.f)
mean(pred == df$Actual.f)
22/30
df$predicted.2 = predict(GLM.2, newdata=df, type="response")
kable(table(df$Actual, df$predicted.2> 0.5))
prob = predict(GLM.2, newdata=df, type="response")
pred = rep(0, dim(df)[1])
pred[prob > .5] = 1
table(pred, df$Actual.f)
mean(pred == df$Actual.f)
df <- read.csv("TestDataSet2.csv")
df$Direction[df$Direction == "DOWN"] <- 0
df$Direction[df$Direction == "UP"] <- 1
train <- head(df, 21)
test <- tail(df, 9)
kable(head(df,5), caption="First Five Data Set Values")
# Model
GLM.2 <- glm(Actual.f ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
df$Actual <- factor(df$Actual)
contrasts(df$Actual)
df <- read.csv("TestDataSet2.csv")
df$Actual <- factor(df$Actual)
contrasts(df$Actual)
df$Direction[df$Direction == "DOWN"] <- 0
df$Direction[df$Direction == "UP"] <- 1
train <- head(df, 21)
test <- tail(df, 9)
kable(head(df,5), caption="First Five Data Set Values")
# Model
GLM.2 <- glm(Actual ~ Direction + Momentum +Alpha2, family=binomial(logit), data=df)
summary(GLM.2)
df$prob.2 = predict(GLM.2, newdata=df, type="response")
pred.2 = rep(0, dim(df)[1])
pred.2[df$prob.2 > .5] = 1
df$predicted.2 <- pred.2
df$predicted.2
kable(table(df$predicted.2, df$predicted.2> 0.5))
kable(table(df$Actual, df$predicted.2> 0.5))
kable(table(df$Actual, df$predicted.2))
accuracy_0.5 = (nrow(df[df$predicted.2 == df$Actual,])/nrow(df))*100
accuracy_0.5
getwd()
setwd("C:/Users/taniy/Documents/GitHub/DSC630")
## Pull the data via the API
dta <- list('seriesid'=c('LNS14000000', 'CUSR0000SAF1',
'CUSR0000SETB01', 'CUSR0000SAM2', 'CUSR0000SA0'),'startyear'=2010,'endyear'=2020)
# fetching data from bls API
response <- blsAPI(dta, 2)
json <- fromJSON(response)
## Process results
apiDF <- function(data){
df <- data.frame(year=character(),
period=character(),
periodName=character(),
value=character(),
stringsAsFactors=FALSE)
i <- 0
for(d in data){
i <- i + 1
df[i,] <- unlist(d)
}
return(df)
}
unemployment.df <- apiDF(json$Results$series[[1]]$data)
food.df <- apiDF(json$Results$series[[2]]$data)
gas.df <- apiDF(json$Results$series[[3]]$data)
medical_services.df <- apiDF(json$Results$series[[4]]$data)
all_items.df <- apiDF(json$Results$series[[5]]$data)
## Change value type from character to numeric
unemployment.df[,4] <- as.numeric(unemployment.df[,4])
food.df[,4] <- as.numeric(food.df[,4])
gas.df[,4] <- as.numeric(gas.df[,4])
medical_services.df[,4] <- as.numeric(medical_services.df[,4])
all_items.df[,4] <- as.numeric(all_items.df[,4])
## Rename value prior to merging
names(unemployment.df)[4] <- 'unemployement_rate'
names(food.df)[4] <- 'food'
names(gas.df)[4] <- 'gas'
names(medical_services.df)[4] <- 'medical_services'
names(all_items.df)[4] <- 'all_items'
## Merge data frames
df1 <- merge(unemployment.df, food.df)
df2 <- merge(df1, gas.df)
df3 <- merge(df2, medical_services.df)
df <- merge(df3, all_items.df)
df$date <- as.POSIXct(strptime(paste0('1',df$periodName,df$year), '%d%B%Y'))
library(ggplot2)
library(ggpubr)
library(knitr)
library(tidyverse)
library(rjson)
library(blsAPI)
library(pastecs)
dta <- list('seriesid'=c('LNS14000000', 'CUSR0000SAF1',
'CUSR0000SETB01', 'CUSR0000SAM2', 'CUSR0000SA0'),'startyear'=2010,'endyear'=2020)
# fetching data from bls API
response <- blsAPI(dta, 2)
json <- fromJSON(response)
## Pull the data via the API
dta <- list('seriesid'=c('LNS14000000', 'CUSR0000SAF1',
'CUSR0000SETB01', 'CUSR0000SAM2', 'CUSR0000SA0'),'startyear'=2010,'endyear'=2020)
# fetching data from bls API
response <- blsAPI(dta, 2)
json <- fromJSON(response)
## Process results
apiDF <- function(data){
df <- data.frame(year=character(),
period=character(),
periodName=character(),
value=character(),
stringsAsFactors=FALSE)
i <- 0
for(d in data){
i <- i + 1
df[i,] <- unlist(d)
}
return(df)
}
unemployment.df <- apiDF(json$Results$series[[1]]$data)
food.df <- apiDF(json$Results$series[[2]]$data)
gas.df <- apiDF(json$Results$series[[3]]$data)
medical_services.df <- apiDF(json$Results$series[[4]]$data)
all_items.df <- apiDF(json$Results$series[[5]]$data)
## Change value type from character to numeric
unemployment.df[,4] <- as.numeric(unemployment.df[,4])
food.df[,4] <- as.numeric(food.df[,4])
gas.df[,4] <- as.numeric(gas.df[,4])
medical_services.df[,4] <- as.numeric(medical_services.df[,4])
all_items.df[,4] <- as.numeric(all_items.df[,4])
## Rename value prior to merging
names(unemployment.df)[4] <- 'unemployement_rate'
names(food.df)[4] <- 'food'
names(gas.df)[4] <- 'gas'
names(medical_services.df)[4] <- 'medical_services'
names(all_items.df)[4] <- 'all_items'
## Merge data frames
df1 <- merge(unemployment.df, food.df)
df2 <- merge(df1, gas.df)
df3 <- merge(df2, medical_services.df)
df <- merge(df3, all_items.df)
df$date <- as.POSIXct(strptime(paste0('1',df$periodName,df$year), '%d%B%Y'))
df
dta <- list('seriesid'=c('LNS14000000', 'CUSR0000SAF1',
'CUSR0000SETB01', 'CUSR0000SAM2', 'CUSR0000SA0'),'startyear'=2010,'endyear'=2020)
# fetching data from bls API
response <- blsAPI(dta, 2)
response
dta
response <- blsAPI(dta, 2)
dta
response
library(ggplot2)
library(ggpubr)
library(knitr)
library(tidyverse)
library(rjson)
library(blsAPI)
library(pastecs)
## Pull the data via the API
dta <- list('seriesid'=c('LNS14000000', 'CUSR0000SAF1',
'CUSR0000SETB01', 'CUSR0000SAM2', 'CUSR0000SA0'),'startyear'=2010,'endyear'=2020)
# fetching data from bls API
response <- blsAPI(dta, 2)
json <- fromJSON(response)
## Process results
apiDF <- function(data){
df <- data.frame(year=character(),
period=character(),
periodName=character(),
value=character(),
stringsAsFactors=FALSE)
i <- 0
for(d in data){
i <- i + 1
df[i,] <- unlist(d)
}
return(df)
}
unemployment.df <- apiDF(json$Results$series[[1]]$data)
food.df <- apiDF(json$Results$series[[2]]$data)
gas.df <- apiDF(json$Results$series[[3]]$data)
medical_services.df <- apiDF(json$Results$series[[4]]$data)
all_items.df <- apiDF(json$Results$series[[5]]$data)
## Change value type from character to numeric
unemployment.df[,4] <- as.numeric(unemployment.df[,4])
food.df[,4] <- as.numeric(food.df[,4])
gas.df[,4] <- as.numeric(gas.df[,4])
medical_services.df[,4] <- as.numeric(medical_services.df[,4])
all_items.df[,4] <- as.numeric(all_items.df[,4])
## Rename value prior to merging
names(unemployment.df)[4] <- 'unemployement_rate'
names(food.df)[4] <- 'food'
names(gas.df)[4] <- 'gas'
names(medical_services.df)[4] <- 'medical_services'
names(all_items.df)[4] <- 'all_items'
## Merge data frames
df1 <- merge(unemployment.df, food.df)
df2 <- merge(df1, gas.df)
df3 <- merge(df2, medical_services.df)
df <- merge(df3, all_items.df)
df$date <- as.POSIXct(strptime(paste0('1',df$periodName,df$year), '%d%B%Y'))
df
var = df %>% select(food, gas)
five_num = summary(var)
desc_stat <- stat.desc(var,basic=FALSE, desc=TRUE, norm=TRUE, p=0.95)
knitr::kable(five_num, digits =2,format = "pandoc", caption = "Summary Statistics Table")
knitr::kable(desc_stat, digits =2,format = "pandoc", caption = "Descriptive Statistics Table")
ggplot(df, aes(x=food)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Consumer Expenditure") + ylab("Food") +
xlim(250,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$HSDegree), sd = sd(df$food)), color = "darkblue")
ggplot(df, aes(x=food)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Consumer Expenditure") + ylab("Food") +
xlim(200,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$HSDegree), sd = sd(df$food)), color = "darkblue")
ggplot(df, aes(x=food)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Consumer Expenditure") + ylab("Food") +
xlim(200,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$food), sd = sd(df$food)), color = "darkblue")
ggplot(df, aes(x=food)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Food") + ylab("Consumer Expenditure") +
xlim(200,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$food), sd = sd(df$food)), color = "darkblue")
ggplot(df, aes(x=food)) +
geom_histogram(bins=40,color="black", fill="lightblue") + ggtitle("Histogram Plot with Bins 40") +
xlab("HS Degree Completion (%)") + ylab("Number of Counties")
ggplot(df, aes(x=food)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Food") + ylab("Consumer Expenditure") +
xlim(200,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$food), sd = sd(df$food)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(200,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(180,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(150,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(150,300) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(150,500) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(150,400) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
ggplot(df, aes(x=gas)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Gas in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Gas") + ylab("Consumer Expenditure") +
xlim(100,400) +
stat_function(fun = dnorm, args = list(mean = mean(df$gas), sd = sd(df$gas)), color = "darkblue")
df
ggplot(df, aes(x=date, y=unemployment_rate)) +
geom_line()
ggtitle("Unemployment rate in U.S. city average") +
xlab("Time") + ylab("Unemployment")
ggplot(df, aes(x=date, y=unemployment_rate)) +
geom_line() +
ggtitle("Unemployment rate in U.S. city average") +
xlab("Time") + ylab("Unemployment")
ggplot(df, aes(x=date, y=unemployement_rate)) +
geom_line() +
ggtitle("Unemployment rate in U.S. city average") +
xlab("Time") + ylab("Unemployment")
## copying data into csv file
write.csv(df, file="bls_data.csv", row.names = FALSE)
ggplot(df, aes(x=food, y=unemployement_rate)) + geom_point()
ggplot(df, aes(x=food, y=unemployement_rate)) +
geom_point() +
ggtitle("Food vs. Unemployment rate") +
xlab("Food") + ylab("Unemployment")
ggplot(df, aes(x=food, y=unemployement_rate)) +
geom_point(color='darkblue') +
ggtitle("Food vs. Unemployment rate") +
xlab("Food") + ylab("Unemployment")
ggplot(df, aes(x=food, y=unemployement_rate)) +
geom_point(color='red') +
ggtitle("Food vs. Unemployment rate") +
xlab("Food") + ylab("Unemployment")
ggplot(df, aes(x=food, y=unemployement_rate)) +
geom_point(color='#56B4E9') +
ggtitle("Food vs. Unemployment rate") +
xlab("Food") + ylab("Unemployment")
ggplot(df, aes(x=food, y=gas)) +
geom_point(color='#E69F00') +
ggtitle("Food vs. gas") +
xlab("Food") + ylab("Gas")
ggplot(df, aes(x=gas, y=unemployement_rate)) +
geom_point(color='#56B4E9') +
ggtitle("Gas vs. Unemployment rate") +
xlab("Gas") + ylab("Unemployment")
ggplot(df, aes(x=all_items, y=gas)) +
geom_point(color='#E69F00') +
ggtitle("All Items vs. gas") +
xlab("all_items") + ylab("Gas")
ggplot(df, aes(x=all_items, y=gas)) +
geom_point(color='#E69F00') +
ggtitle("All Items Consumption vs. Gas Consumption") +
xlab("All Items") + ylab("Gas")
ggplot(df, aes(x=all_items, y=gas)) +
geom_point(color='crimson') +
ggtitle("All Items Consumption vs. Gas Consumption") +
xlab("All Items") + ylab("Gas")
ggplot(df, aes(x=all_items, y=gas)) +
geom_point(color='red') +
ggtitle("All Items Consumption vs. Gas Consumption") +
xlab("All Items") + ylab("Gas")
cor(df)
cor(var)
df
var2 = df %>% select(unemployement_rate, food, gas, medical_services, all_items)
cor(var2)
knitr::kable(cor(var2), digits =2,format = "pandoc", caption = "Correlation Coefficient of variables")
library(corrplot)
corrplot(var2, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
corrplot(var2)
corrplot(var2, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
corrplot(var, method = "circle")
corrplot(var2, method = "circle")
df
str(df)
var2 <- na.omit(var2)
str(var2)
corrplot(var2)
corrplot(as.matrix(var2), is.corr = FALSE)
corrplot(var2, is.corr = FALSE)
corrplot(as.matrix(var2), is.corr = FALSE)
corrplot(as.matrix(var2), is.corr = TRUE)
res <- cor(var)
res <- cor(var2)
corrplot(res)
corrplot(cor(var2), type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
install.packages("gtsummary")
install.packages("gtsummary")
library(gtsummary)
table1 <- tbl_summary(var2)
summary_table(var2, summaries = qsummary(x), by = NULL)
install.packages("qwraps2")
library(qwraps2)
summary_table(var2, summaries = qsummary(x), by = NULL)
summary_table(var2, summaries)
summary_table(var2)
summary(var2)
kable(summary(var2))
kable(str(var2))
summary(df)
kable(summary(df))
str(df)
summary(df)
stat.desc(var2,basic=FALSE, desc=TRUE, norm=TRUE, p=0.95)
ggplot(df, aes(x=all_items)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue")
ggplot(df, aes(x=all_items)) +
geom_histogram(aes(y=..density..), bins=40,color="black", fill="lightblue") +
ggtitle("Food in U.S. city average, all urban consumers, with Normal Curve") +
xlab("Food") + ylab("Consumer Expenditure") +
xlim(150,275) +
stat_function(fun = dnorm, args = list(mean = mean(df$food), sd = sd(df$food)), color = "darkblue")
desc_stat <- stat.desc(var2,basic=FALSE, desc=TRUE, norm=TRUE, p=0.95)
knitr::kable(desc_stat, digits =2,format = "pandoc", caption = "Descriptive Statistics Table")
ggplot(df, aes(x=food)) +
geom_histogram(bins=40,color="black", fill="lightblue") +
xlab("all_items") + ylab("Consumer Expenditure") +
xlim(200,275)
desc_stat <- stat.desc(var,basic=TRUE, desc=TRUE, norm=TRUE, p=0.95)
knitr::kable(desc_stat, digits =2,format = "pandoc", caption = "Descriptive Statistics Table")
knitr::kable(summary(var)
kable(summary(var)
kable(summary(var))
